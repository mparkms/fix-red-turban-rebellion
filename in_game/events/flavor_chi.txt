namespace = flavor_chi

scripted_trigger is_yuan_china = {
	culture = culture:mongolian_culture
}

flavor_chi.33 = {
    type = country_event
    title = flavor_chi.33.title
    desc = flavor_chi.33.desc
    major = yes
    fire_only_once = yes

    dynamic_historical_event = {
        tag = CHI
        tag = YUA
        from = 1337.1.1
        to = 1821.1.1
        monthly_chance = 10
    }

    illustration_tags = {
        10 = angry
        10 = exterior
    }

    immediate = {
        event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
    }
    trigger = {
        is_yuan_china = yes
        in_civil_war = no
        NOT = { international_organization:middle_kingdom.leader_country ?= ROOT }
    }

    option = {
        name = flavor_chi.33.a

        if = {
            limit = {
                NOT = { tag = YUA }
            }
            change_country_tag = YUA
        }
        change_country_name = NORTHERN_YUA
        if = {
            # if capital not in Mongolia, move capital to Karakorum
            limit = {
                not = {
                    capital.region = region:mongolia_region
                }
            }
            if = {
                limit = { location:karakorum.owner = root }
                set_capital = location:karakorum
            }
            # or largest location in Mongolia
            else_if = {
                limit = {
                    region:mongolia_region = {
                        any_location_in_region = { owner = root }
                    }
                }
                region:mongolia_region = {
                    ordered_location_in_region = {
                        order_by = {
                            value = population
                        }
                        max = 1
                        save_scope_as = new_capital
                    }
                }
                set_capital = scope:new_capital
            }
        }
    }
}